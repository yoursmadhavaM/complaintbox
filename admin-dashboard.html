<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard - Anonymous Complaint Box</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
</head>
<body>
  <div class="college-banner">
      <img src="https://image2url.com/images/1756274440672-9059ea59-82f6-4890-8342-990e01fee35e.png" alt="RVR & JC College of Engineering Banner" class="banner-image">
  </div>
  <!-- Admin Welcome Modal -->
  <div id="adminWelcomeModal" class="admin-welcome-modal">
    <div class="admin-welcome-content">
      <h2>Welcome, Admin!</h2>
      <p>Click below to enter the Admin Dashboard.</p>
      <button id="adminEnterBtn">Go to Admin Dashboard</button>
    </div>
  </div>
  <div class="dashboard-container" style="display:none;">
    <nav class="dashboard-sidebar">
        <ul>
            <li class="active" data-section="complaints"><i class="fa-solid fa-list"></i> Complaints Submitted</li>
            <li data-section="resolved"><i class="fa-solid fa-check-circle"></i> Complaints Resolved</li>
            <li data-section="tokens"><i class="fa-solid fa-key"></i> All Tokens</li>
            <li data-section="bouncedComplaints"><i class="fa-solid fa-exclamation-triangle"></i> Bounced Complaints</li>
            <li data-section="ratings"><i class="fa-solid fa-star"></i> Student Ratings</li>
            <li data-section="statistics"><i class="fa-solid fa-chart-bar"></i> Statistics & Reports</li>
            <li class="sidebar-divider"></li>
            

        </ul>
    </nav>
    <main class="dashboard-main">
      <!-- Filter bar only for Complaints Submitted section -->
      <div id="filterBar" class="filter-bar" style="display:block;">
        <label>Status:
          <select id="filterStatus">
            <option value="">All</option>
            <option value="pending">Pending</option>
            <option value="resolved">Resolved</option>
          </select>
        </label>
        <label>Type:
          <select id="filterType">
            <option value="">All</option>
            <option value="academic">Academic</option>
            <option value="infrastructure">Infrastructure</option>
            <option value="faculty">Faculty</option>
            <option value="hostel">Hostel</option>
            <option value="transportation">Transportation</option>
            <option value="canteen">Canteen</option>
            <option value="library">Library</option>
            <option value="sports">Sports</option>
            <option value="other">Other</option>
          </select>
        </label>
        <label>Date Range:
          <select id="filterDateRange">
            <option value="">All Time</option>
            <option value="today">Today</option>
            <option value="yesterday">Yesterday</option>
            <option value="week">This Week</option>
            <option value="month">This Month</option>
            <option value="year">This Year</option>
            <option value="custom">Custom Range</option>
          </select>
        </label>
        <div id="customDateInputs" style="display:none;">
          <label>From: <input type="date" id="filterDateFrom"></label>
          <label>To: <input type="date" id="filterDateTo"></label>
        </div>
        <button id="applyFiltersBtn"><i class="fa-solid fa-filter"></i> Apply Filters</button>
        <button id="clearFiltersBtn"><i class="fa-solid fa-times"></i> Clear</button>
        <button id="refreshBtn"><i class="fa-solid fa-rotate"></i> Refresh</button>
      </div>
      
      
      
      <section id="complaintsSection" class="dashboard-section" style="display:block;">
        <h2>Complaints Submitted</h2>
        <table class="admin-table">
          <thead>
            <tr>
              <th>ID</th>
              <th>Type</th>
              <th>Status</th>
              <th>User/Token</th>
              <th>Date</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="complaintsTableBody"></tbody>
        </table>
      </section>
      
      <section id="resolvedSection" class="dashboard-section" style="display:none;">
        <h2>Complaints Resolved</h2>
        <table class="admin-table">
          <thead>
            <tr>
              <th>ID</th>
              <th>Type</th>
              <th>Status</th>
              <th>User/Token</th>
              <th>Date</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="resolvedComplaintsTableBody"></tbody>
        </table>
      </section>
      
      <section id="tokensSection" class="dashboard-section" style="display:none;">
        <h2>All Tokens</h2>
        <!-- Search bar for tokens -->
        <div style="margin-bottom: 20px; display: flex; gap: 10px; align-items: center;">
          <input type="text" id="tokenSearchInput" placeholder="Search by token ID, complaint type, or user..." style="flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px;">
          <button id="tokenSearchBtn" style="background: #007bff; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">
            <i class="fa-solid fa-search"></i> Search
          </button>
          <button id="clearTokenSearchBtn" style="background: #6c757d; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">
            <i class="fa-solid fa-times"></i> Clear
          </button>
        </div>
        <table class="admin-table">
          <thead>
            <tr>
              <th>Token ID</th>
              <th>Complaint Type</th>
              <th>Status</th>
              <th>User/Anonymous</th>
              <th>Date Created</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="adminTokensTableBody"></tbody>
        </table>
      </section>
      
      <section id="bouncedComplaintsSection" class="dashboard-section" style="display:none;">
        <h2>Bounced Complaints</h2>
        <p style="color: #e53935; margin-bottom: 20px;">
          <i class="fa-solid fa-exclamation-triangle"></i>
          These complaints were marked as resolved by admin but users disagreed with the resolution.
        </p>
        <table class="admin-table">
          <thead>
            <tr>
              <th>Token ID</th>
              <th>Complaint Type</th>
              <th>Original Resolution</th>
              <th>User/Anonymous</th>
              <th>Date Bounced</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="bouncedComplaintsTableBody"></tbody>
        </table>
      </section>
      

      
      <section id="statisticsSection" class="dashboard-section" style="display:none;">
        <h2>Statistics & Reports</h2>
        
        <!-- Summary Cards -->
        <div class="stats-summary" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;">
          <div class="stat-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 10px; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
            <h3 style="margin: 0 0 10px 0; font-size: 2rem;" id="totalComplaints">-</h3>
            <p style="margin: 0; font-size: 0.9rem;">Total Complaints</p>
          </div>
          <div class="stat-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; padding: 20px; border-radius: 10px; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
            <h3 style="margin: 0 0 10px 0; font-size: 2rem;" id="pendingComplaints">-</h3>
            <p style="margin: 0; font-size: 0.9rem;">Pending</p>
          </div>
          <div class="stat-card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; padding: 20px; border-radius: 10px; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
            <h3 style="margin: 0 0 10px 0; font-size: 2rem;" id="resolvedComplaints">-</h3>
            <p style="margin: 0; font-size: 0.9rem;">Resolved</p>
          </div>
          <div class="stat-card" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color: white; padding: 20px; border-radius: 10px; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
            <h3 style="margin: 0 0 10px 0; font-size: 2rem;" id="resolutionRate">-</h3>
            <p style="margin: 0; font-size: 0.9rem;">Resolution Rate</p>
          </div>
        </div>

        <!-- Report Filters -->
        <div class="report-filters" style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 30px;">
          <h3 style="margin: 0 0 15px 0;">Generate Reports</h3>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; align-items: end;">
            <div>
              <label style="display: block; margin-bottom: 5px; font-weight: 600;">Report Type:</label>
              <select id="reportType" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                <option value="summary">Summary Report</option>
                <option value="detailed">Detailed Report</option>
                <option value="typewise">Type-wise Analysis</option>
                <option value="timeline">Timeline Analysis</option>
              </select>
            </div>
            <div>
              <label style="display: block; margin-bottom: 5px; font-weight: 600;">Time Period:</label>
              <select id="reportPeriod" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                <option value="today">Today</option>
                <option value="week">This Week</option>
                <option value="month">This Month</option>
                <option value="quarter">This Quarter</option>
                <option value="year">This Year</option>
                <option value="custom">Custom Range</option>
              </select>
            </div>
            <div id="reportCustomDates" style="display: none;">
              <label style="display: block; margin-bottom: 5px; font-weight: 600;">From:</label>
              <input type="date" id="reportDateFrom" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
            </div>
            <div id="reportCustomDates2" style="display: none;">
              <label style="display: block; margin-bottom: 5px; font-weight: 600;">To:</label>
              <input type="date" id="reportDateTo" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
            </div>
            <div>
              <button id="generateReportBtn" style="background: #007bff; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: 600;">
                <i class="fa-solid fa-chart-line"></i> Generate Report
              </button>
            </div>
          </div>
        </div>

        <!-- Report Results -->
        <div id="reportResults" style="display:none;">
          <h3>Report Results</h3>
          <div id="reportContent"></div>
        </div>

      </section>
      
      <!-- Student Ratings Section -->
      <section id="ratingsSection" class="dashboard-section" style="display:none;">
        <h2>Student Ratings & Feedback</h2>
        
        <!-- Rating Statistics -->
        <div class="rating-stats-container" style="margin-bottom: 30px;">
          <h3>Rating Overview</h3>
          <div id="adminRatingStats">
            <!-- Rating statistics will be loaded here -->
          </div>
        </div>
        
        <!-- Complaints Needing Rating -->
        <div class="rating-queue-container" style="margin-bottom: 30px;">
          <h3>Complaints Awaiting Student Rating</h3>
          <div id="complaintsNeedingRating">
            <!-- Complaints needing rating will be loaded here -->
          </div>
        </div>
        
        <!-- Recent Ratings -->
        <div class="recent-ratings-container">
          <h3>Recent Student Ratings</h3>
          <div id="recentRatings">
            <!-- Recent ratings will be loaded here -->
          </div>
        </div>
      </section>
      

    </main>
  </div>
  <!-- Modal for complaint details -->
  <div id="detailsModal" class="modal-overlay" style="display:none;">
    <div class="modal-content">
      <button id="closeDetailsModalBtn" style="float:right; background:none; border:none; font-size:1.5rem; color:#4f8cff; cursor:pointer;" aria-label="Close">&times;</button>
      <h2>Complaint Details</h2>
      <div id="detailsContent"></div>
    </div>
  </div>
  <!-- Modal for resolution description -->
  <div id="resolutionModal" class="modal-overlay" style="display:none;">
    <div class="modal-content">
      <h2>Resolve Complaint</h2>
      <form id="resolutionForm">
        <label for="resolutionDescription">Resolution Description (required):</label>
        <textarea id="resolutionDescription" name="resolutionDescription" rows="3" required placeholder="Enter resolution details..."></textarea>
        <div style="margin-top:12px;">
          <button type="submit" style="background:#388e3c;color:#fff;border:none;border-radius:6px;padding:8px 16px;font-weight:600;">Resolve</button>
          <button type="button" id="cancelResolutionBtn" style="background:#e53935;color:#fff;border:none;border-radius:6px;padding:8px 16px;font-weight:600;margin-left:10px;">Cancel</button>
        </div>
      </form>
      <div id="resolutionError" style="color:#e53935;margin-top:10px;"></div>
    </div>
  </div>
      <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <!-- Your main JS -->
  <script src="script.js"></script>
</body>
</html> 